# Telegram Queue Bot

**Telegram-бот для организации электронной очереди и записи на приём.**

Бот предназначен для автоматизации процесса записи клиентов на приём к специалисту или на получение услуг. Система работает через Telegram, обеспечивая удобное бронирование временных слотов с обязательной регистрацией пользователей.

## Кейсы использования

- **Консультационные услуги**: встречи с юристами, бухгалтерами, психологами
- **Государственные и муниципальные услуги**: запись в МФЦ, на получение документов
- **Медицинские учреждения**: запись к врачу, стоматологу, на медицинские процедуры
- **Салоны красоты и СПА**: бронирование времени для стрижки, маникюра, массажа
- **Автосервисы**: планирование технического обслуживания автомобилей

## Особенности

- Минималистичная архитектура (~1400 строк кода)
- Прямой доступ к SQLite без лишних абстракций
- Простая конфигурация через переменные окружения
- **Обязательная регистрация пользователей с номером телефона**
- Автоматическая регистрация команд в меню Telegram
- Базовые команды: `/start`, `/book`, `/myslots`, `/cancel`, `/help`, `/admin`
- Обработка callback queries для интерактивных кнопок
- Защита от неавторизованного бронирования
- Rate limiting для защиты от спама
- Поддержка часовых поясов и гибкого расписания
- Docker-ready с простым развёртыванием

## Установка

1. Клонировать репозиторий
2. Скопировать `.env.example` в `.env` и заполнить своими значениями
3. Установить зависимости: `go mod download`
4. Запустить: `make run` (локально) или `make docker-run` (в Docker)

## Структура проекта

```text
├── main.go        # Основная логика и хендлеры (704 строки)
├── config.go      # Конфигурация с .env загрузкой (90 строк)
├── database.go    # SQL операции + управление пользователями (575 строк)
├── middleware.go  # Rate limiting и логирование (75 строк)
├── Dockerfile     # Multi-stage Docker build
├── Makefile       # Команды сборки и запуска
└── .env.example   # Пример конфигурации
```

## Команды сборки и запуска

- `make build` - собрать бинарник
- `make run` - запустить локально
- `make docker-build` - собрать Docker образ
- `make docker-run` - запустить в Docker
- `make clean` - очистить артефакты сборки
- `make clean-db` - удалить базу данных

## Конфигурация

Основные параметры настройки через переменные окружения:

- `TELEGRAM_TOKEN` - токен Telegram бота (обязательно)
- `WEBHOOK_URL` - URL для webhook (обязательно)
- `SERVER_ADDRESS` - адрес сервера (по умолчанию `:8080`)
- `DB_FILE` - путь к файлу базы данных (по умолчанию `queue.db`)
- `WORK_START` - начало рабочего дня (по умолчанию `09:00`)
- `WORK_END` - конец рабочего дня (по умолчанию `18:00`)
- `SLOT_DURATION` - длительность слота в минутах (по умолчанию `30`)
- `SCHEDULE_DAYS` - количество дней для планирования (по умолчанию `7`)
- `SKIP_WEEKEND` - пропускать выходные (по умолчанию `true`)
- `ADMIN_IDS` - ID администраторов через запятую

## Зависимости

- `github.com/go-telegram-bot-api/telegram-bot-api/v5` - Telegram Bot API
- `github.com/mattn/go-sqlite3` - SQLite драйвер
- `github.com/joho/godotenv` - загрузка переменных из .env файла
